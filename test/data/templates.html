<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>srf</title>
  <link rel="icon" type="image/png" href="/img/logo.png">
  <link rel="stylesheet" href="/css/.css">
  <style>
    
  </style>
</head>
<body>
  <div id="content">
    <style>
  th {
    text-align: left;
  }
  td {
    text-align: right;
  }
</style>
<h1><a href="/">Spaced Repetition Flashcards</a></h1>
<h2>Templates</h2>
<a href="/fieldset" onclick="return add()"><button>Add</button></a>
<table border="1" class="sortable">
<thead>
  <tr>
      <th>id</th>
      <th>templateset</th>
      <th>name</th>
      <th>front</th>
      <th>back</th>
      <th>css</th>
  </tr>
</thead>
<tbody>
    <tr>
        <td>1</td>
        <td>ts1</td>
        <td>Card2</td>
        <td>{{Audio}}</td>
        <td>{{Audio}}&lt;br&gt;{{Hanzi}}&lt;br&gt;{{Pinyin}}&lt;br&gt;{{English}}</td>
        <td>.card { font-size: 35px; }</td>
    </tr>
    <tr>
        <td>2</td>
        <td>ts1</td>
        <td>Card2</td>
        <td>{{Hanzi}}</td>
        <td>{{Audio}}&lt;br&gt;{{Hanzi}}&lt;br&gt;{{Pinyin}}&lt;br&gt;{{English}}</td>
        <td>.card { font-size: 35px; }</td>
    </tr>
</tbody>
</table>
<script src="js/sorttable.js"></script>
<script>
  function add () {
    window.open('/template', 'Edit Template', 'height=800,width=650');
    return false;
  }
  document.querySelectorAll('table tr')
  .forEach(e => e.addEventListener('click', (event) => {
    const cells = event.currentTarget.getElementsByTagName('td');
    window.open('/template/' + cells[0].innerText, 'Edit Template',
      'height=800,width=600');
  }));
</script>
  </div>
  <script>
    document.addEventListener("keypress", keyCapt, false);
    function keyCapt (e) {
          console.log('keyCode: ', e.keyCode);
      if (e.keyCode === 32) {
        let el = document.getElementsByClassName('default_action')[0];
        if (el) el.click();
      } else if (e.keyCode === 98) { // b
        let el = document.getElementsByClassName('shortcut_b')[0];
        if (el) el.click();
      } else if (e.keyCode === 101) { // j
        let el = document.getElementsByClassName('shortcut_e')[0];
        if (el) el.click();
      } else if (e.keyCode === 106) { // j
        let el = document.getElementsByClassName('shortcut_j')[0];
        if (el) el.click();
      } else if (e.keyCode === 107) { // k
        let el = document.getElementsByClassName('shortcut_k')[0];
        if (el) el.click();
      } else if (e.keyCode === 108) { // l
        let el = document.getElementsByClassName('shortcut_l')[0];
        if (el) el.click();
      } else if (e.keyCode === 112) { // r
        let el = document.getElementsByClassName('shortcut_p')[0];
        if (el) el.click();
      } else if (e.keyCode === 114) { // r
        let el = document.getElementsByClassName('shortcut_r')[0];
        if (el) el.click();
      } else if (e.keyCode === 115) { // s
        let el = document.getElementsByClassName('shortcut_s')[0];
        if (el) el.click();
      } else if (e.keyCode === 59) { // ;
        let el = document.getElementsByClassName('shortcut_semicolon')[0].click();
        if (el) el.click();
      }
    }
    // let x = document.getElementById('myaudio');
    // x.volume = 0.2;
    // The DOM is stupid: getElementsByTagName doesn't return an array
    // of elements. Instead, it returns an HTMLCollection, which is an
    // "array-like object" which is not like an array. So, one has to
    // do stupid shit like the following to iterate over the elements.
    let elements = document.getElementsByTagName('audio');
    for (let element of elements) {
      element.volume = 0.4;
      let current = 0;
      element.src = audioFiles[current];
      element.addEventListener('ended', function (e) {
        current++;
        if (current == audioFiles.length) current = 0;
        element.src = audioFiles[current];
        if (current === 0) {
          element.pause();
        }
      });
    }

    function replay () {
      let elements = document.getElementsByTagName('audio');
      for (let element of elements) {
        element.play();
      }
    }
  </script>
</body>
</html>
